<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FiqhFacile - Niveau 3</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<header class="navbar">
  <div class="container nav-container">
    <h1 class="logo">FiqhFacile</h1>
    <nav>
      <ul class="nav-links">
        <li><a href="index.html">Accueil</a></li>
        <li><a href="cours.html" class="active">Cours</a></li>
        <li><a href="quiz.html">Quiz</a></li>
        <li><a href="contact.html">Contact</a></li>
        <li><a href="login.html">Connexion</a></li>
        <li><a href="profil.html">Profil</a></li>
      </ul>
    </nav>
  </div>
</header>

<main class="container">
  <h2 class="text-center">ğŸ“˜ Niveau 3 â€“ SirÄt al-MoustaqÄ«m</h2>
  <p class="text-center">Coche les chapitres que tu as terminÃ©s. La progression est enregistrÃ©e si tu es connectÃ©.</p>

  <div class="progress-wrapper">
    <div class="progress-bar">
      <div id="progress-value" class="progress-value" style="width: 0%;">0%</div>
    </div>
  </div>

  <ul id="chapitres-list" class="chapter-list"></ul>
  <ul class='chapter-list'>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon1" /> Le droit le plus Ã©minent que Dieu a sur Ses esclaves</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon2" /> Du sens des deux TÃ©moignages</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon3" /> De lâ€™obligation que doit observer tout responsable (moukallaf)</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon4" /> Aucune religion autre que lâ€™IslÄm nâ€™est vÃ©ritable</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon5" /> Du Jugement relatif Ã  celui qui se rÃ©clame musulman tout en contredisant lâ€™IslÄm</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon6" /> Ã‰claircissements des sortes de mÃ©crÃ©ance</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon7" /> La mÃ©crÃ©ance par la croyance</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon8" /> La mÃ©crÃ©ance par lâ€™acte</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon9" /> La mÃ©crÃ©ance par la parole</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon10" /> De lâ€™exception dans la mÃ©crÃ©ance par la parole</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon11" /> Remarque importante</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon12" /> De la classification de la mÃ©crÃ©ance</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon13" /> Lâ€™assimilation</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon14" /> La dÃ©nÃ©gation</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon15" /> Lâ€™athÃ©isme</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon16" /> La prÃ©servation contre lâ€™Enfer</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon17" /> Le commencement de la crÃ©ation</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon18" /> La prÃ©Ã©ternitÃ© de Dieu</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon19" /> Lâ€™exemption de Dieu de la spatialisation</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon20" /> Les 13 attributs de Dieu (dÃ©taillÃ©s un par un)</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon21" /> La perfection absolue de tous les attributs de Dieu</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon22" /> Lâ€™unicitÃ© de Dieu</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon23" /> Le Tawá¸¥Ä«d dans la Seigneurie</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon24" /> Le Tawá¸¥Ä«d dans lâ€™adoration</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon25" /> Ce que signifie Â« Dieu est au-dessus du TrÃ´ne Â»</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon26" /> Du sens des versets Ã©quivoques</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon27" /> Lâ€™erreur des anthropomorphistes</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon28" /> La voie des gens de la vÃ©ritÃ© dans lâ€™interprÃ©tation des textes</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon29" /> Lâ€™imitation aveugle et ses consÃ©quences</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon30" /> La dÃ©finition de la secte sauvÃ©e</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon31" /> Lâ€™obligation de suivre la vÃ©ritÃ©</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon32" /> De la voie Ã  suivre pour celui qui dÃ©sire la guidÃ©e</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon33" /> Lâ€™ordonnance dâ€™avertir contre les innovateurs</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon34" /> Du statut des groupes Ã©garÃ©s</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon35" /> Les plus graves des Ã©garÃ©s</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon36" /> Lâ€™obligation de fuir les gens de lâ€™Ã©garement</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon37" /> Lâ€™autorisation de citer leurs noms</label>
  </li>
  <li class="chapter-item">
    <label><input type="checkbox" data-id="niveau3_lecon38" /> Conclusion</label>
  </li>
</ul>
</main>
<div class="pdf-download text-center" style="margin-top: 3rem;">
  <a href="La voie de la guidÃ©e.pdf" target="_blank" class="btn">
    ğŸ“„ TÃ©lÃ©charger le livre SirÄt al-MoustaqÄ«m (PDF)
  </a>
</div>
<footer class="footer">
  <div class="container">
    <p>&copy; 2025 FiqhFacile - Tous droits rÃ©servÃ©s.</p>
  </div>
</footer>

<script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCyJcc6CWbLRoWWzW6Vy4mUeinPeSlMYNA",
  authDomain: "fiqhfacile.firebaseapp.com",
  projectId: "fiqhfacile",
  storageBucket: "fiqhfacile.firebasestorage.app",
  messagingSenderId: "525035450795",
  appId: "1:525035450795:web:c53c2f8351398218e222ee"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

const chapitres = [{"id": "niveau3_lecon1", "titre": "Le droit le plus Ã©minent que Dieu a sur Ses esclaves", "pourcentage": 2.63}, {"id": "niveau3_lecon2", "titre": "Du sens des deux TÃ©moignages", "pourcentage": 2.63}, {"id": "niveau3_lecon3", "titre": "De lâ€™obligation que doit observer tout responsable (moukallaf)", "pourcentage": 2.63}, {"id": "niveau3_lecon4", "titre": "Aucune religion autre que lâ€™IslÄm nâ€™est vÃ©ritable", "pourcentage": 2.63}, {"id": "niveau3_lecon5", "titre": "Du Jugement relatif Ã  celui qui se rÃ©clame musulman tout en contredisant lâ€™IslÄm", "pourcentage": 2.63}, {"id": "niveau3_lecon6", "titre": "Ã‰claircissements des sortes de mÃ©crÃ©ance", "pourcentage": 2.63}, {"id": "niveau3_lecon7", "titre": "La mÃ©crÃ©ance par la croyance", "pourcentage": 2.63}, {"id": "niveau3_lecon8", "titre": "La mÃ©crÃ©ance par lâ€™acte", "pourcentage": 2.63}, {"id": "niveau3_lecon9", "titre": "La mÃ©crÃ©ance par la parole", "pourcentage": 2.63}, {"id": "niveau3_lecon10", "titre": "De lâ€™exception dans la mÃ©crÃ©ance par la parole", "pourcentage": 2.63}, {"id": "niveau3_lecon11", "titre": "Remarque importante", "pourcentage": 2.63}, {"id": "niveau3_lecon12", "titre": "De la classification de la mÃ©crÃ©ance", "pourcentage": 2.63}, {"id": "niveau3_lecon13", "titre": "Lâ€™assimilation", "pourcentage": 2.63}, {"id": "niveau3_lecon14", "titre": "La dÃ©nÃ©gation", "pourcentage": 2.63}, {"id": "niveau3_lecon15", "titre": "Lâ€™athÃ©isme", "pourcentage": 2.63}, {"id": "niveau3_lecon16", "titre": "La prÃ©servation contre lâ€™Enfer", "pourcentage": 2.63}, {"id": "niveau3_lecon17", "titre": "Le commencement de la crÃ©ation", "pourcentage": 2.63}, {"id": "niveau3_lecon18", "titre": "La prÃ©Ã©ternitÃ© de Dieu", "pourcentage": 2.63}, {"id": "niveau3_lecon19", "titre": "Lâ€™exemption de Dieu de la spatialisation", "pourcentage": 2.63}, {"id": "niveau3_lecon20", "titre": "Les 13 attributs de Dieu (dÃ©taillÃ©s un par un)", "pourcentage": 2.63}, {"id": "niveau3_lecon21", "titre": "La perfection absolue de tous les attributs de Dieu", "pourcentage": 2.63}, {"id": "niveau3_lecon22", "titre": "Lâ€™unicitÃ© de Dieu", "pourcentage": 2.63}, {"id": "niveau3_lecon23", "titre": "Le Tawá¸¥Ä«d dans la Seigneurie", "pourcentage": 2.63}, {"id": "niveau3_lecon24", "titre": "Le Tawá¸¥Ä«d dans lâ€™adoration", "pourcentage": 2.63}, {"id": "niveau3_lecon25", "titre": "Ce que signifie Â« Dieu est au-dessus du TrÃ´ne Â»", "pourcentage": 2.63}, {"id": "niveau3_lecon26", "titre": "Du sens des versets Ã©quivoques", "pourcentage": 2.63}, {"id": "niveau3_lecon27", "titre": "Lâ€™erreur des anthropomorphistes", "pourcentage": 2.63}, {"id": "niveau3_lecon28", "titre": "La voie des gens de la vÃ©ritÃ© dans lâ€™interprÃ©tation des textes", "pourcentage": 2.63}, {"id": "niveau3_lecon29", "titre": "Lâ€™imitation aveugle et ses consÃ©quences", "pourcentage": 2.63}, {"id": "niveau3_lecon30", "titre": "La dÃ©finition de la secte sauvÃ©e", "pourcentage": 2.63}, {"id": "niveau3_lecon31", "titre": "Lâ€™obligation de suivre la vÃ©ritÃ©", "pourcentage": 2.63}, {"id": "niveau3_lecon32", "titre": "De la voie Ã  suivre pour celui qui dÃ©sire la guidÃ©e", "pourcentage": 2.63}, {"id": "niveau3_lecon33", "titre": "Lâ€™ordonnance dâ€™avertir contre les innovateurs", "pourcentage": 2.63}, {"id": "niveau3_lecon34", "titre": "Du statut des groupes Ã©garÃ©s", "pourcentage": 2.63}, {"id": "niveau3_lecon35", "titre": "Les plus graves des Ã©garÃ©s", "pourcentage": 2.63}, {"id": "niveau3_lecon36", "titre": "Lâ€™obligation de fuir les gens de lâ€™Ã©garement", "pourcentage": 2.63}, {"id": "niveau3_lecon37", "titre": "Lâ€™autorisation de citer leurs noms", "pourcentage": 2.63}, {"id": "niveau3_lecon38", "titre": "Conclusion", "pourcentage": 2.63}];

let currentUser = null;
let savedProgress = {};

function updateProgressBar() {
  const total = chapitres.length;
  const checked = document.querySelectorAll('input[type=checkbox]:checked').length;
  const percent = Math.round((checked / total) * 100);
  const progressBar = document.getElementById("progress-value");
  progressBar.style.width = percent + "%";
  progressBar.innerText = percent + "%";
}

function updateProgressionInFirebase() {
  if (!currentUser) return;
  const checkedStates = {};
  document.querySelectorAll('input[type=checkbox]').forEach(input => {
    checkedStates[input.dataset.id] = input.checked;
  });
  db.collection("progression").doc(currentUser.uid).set(checkedStates, { merge: true });
}

function createChecklist() {
  const list = document.getElementById("chapitres-list");
  list.innerHTML = "";
  chapitres.forEach(chap => {
    const li = document.createElement("li");
    li.className = "chapter-item";
    const label = document.createElement("label");
    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.dataset.id = chap.id;
    checkbox.checked = savedProgress[chap.id] || false;
    checkbox.onchange = () => {
      updateProgressBar();
      updateProgressionInFirebase();
    };
    label.appendChild(checkbox);
    label.append(" " + chap.titre);
    li.appendChild(label);
    list.appendChild(li);
  });
  updateProgressBar();
}

auth.onAuthStateChanged(user => {
  currentUser = user;
  if (user) {
    db.collection("progression").doc(user.uid).get().then(doc => {
      savedProgress = doc.data() || {};
      createChecklist();
    });
  } else {
    createChecklist(); // mÃªme sans Ãªtre connectÃ©
  }
});
</script>

</body>
</html>
